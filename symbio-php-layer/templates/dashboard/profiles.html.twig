{% extends 'base.html.twig' %}

{% block title %}{{ 'profiles.title'|trans }}{% endblock %}

{% block body %}
<h2>{{ 'profiles.heading'|trans }}</h2>

{% if message %}
    <p style="color:red">{{ 'profiles.error'|trans }}: {{ message }}</p>
{% endif %}

{% if profiles %}
    <table border="1" cellpadding="5">
        <tr>
            <th>{{ 'profiles.userid'|trans }}</th>
            <th>{{ 'profiles.full_name'|trans }}</th>
            <th>{{ 'profiles.bio'|trans }}</th>
            <th>{{ 'profiles.skills'|trans }}</th>
            <th>{{ 'profiles.avatar'|trans }}</th>
            <th>{{ 'profiles.rating'|trans }}</th>
            <th>{{ 'profiles.completed_tasks'|trans }}</th>
            <th>{{ 'profiles.actions'|trans }}</th>
        </tr>
        {% for p in profiles %}
            <tr>
                <td>{{ p.user_id }}</td>
                <td>{{ p.full_name }}</td>
                <td>{{ p.bio }}</td>
                <td>{{ p.skills|join(',') }}</td>
                <td>
                    {% if p.avatar %}
                        <img src="{{ p.avatar }}" alt="{{ 'profiles.avatar'|trans }}" style="max-width:50px;">
                    {% endif %}
                </td>
                <td>{{ p.rating }}</td>
                <td>{{ p.completed_tasks }}</td>
                <td>
                    {% if p.user_id != userId %}
                        <form method="POST" style="margin:0;">
                            <input type="hidden" name="requested_id" value="{{ p.user_id }}">
                            <button type="submit" name="create_chat_request">{{ 'profiles.request_chat'|trans }}</button>
                        </form>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
{% else %}
    <p>{{ 'profiles.no_profiles'|trans }}</p>
{% endif %}

<p><a href="{{ path('app_dashboard') }}">{{ 'profiles.back'|trans }}</a></p>
{% endblock %}

